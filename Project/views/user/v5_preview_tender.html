<!DOCTYPE html>
<html>
  <head>
    <title>Preview</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="css/confirm_tender.css">
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
    <script  src="javascript/cookies.js"></script>
    <!-- <script src="https://code.jquery.com/jquery-3.5.1.slim.js" integrity="sha256-DrT5NfxfbHvMHux31Lkhxg42LY6of8TaYyK50jnxRnM=" crossorigin="anonymous"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.min.js"></script>
    <!-- <script type="text/javascript" src="https://html2canvas.hertzen.com/dist/html2canvas.js"></script> -->
    <!-- <script src="html2pdf.bundle.min.js"></script> -->
    
  </head>
  <header>
    <nav id="nav_bar">
      <a href="/v7_homepage.html">Home</a>
      <a href="/v3_see_tender.html">Tender</a>
      <a id="log_a" href="/v1_login.html">Login</a>
    </nav>
  </header>
  <body>
    <div  class="cont" style="height: 1300px;">
      <div id='pdf'>
      <br>
      <h2>Application</h2><br>
      <div style="text-align: right;">
        <p><strong>Application Status:</strong></p>
        <p id= "app" class="status2">Submitted</p>
      </div>
      <h3 style="text-align: left;">Tender Details</h3>
      <div id="pdf1">
      <table id="t1">
        <tr>
          <td><label><strong>Tender Id: </strong></label></td>
          <td><label id="et_id"></label></td>
          <td><label><strong>Reference No: </strong></label></td>
          <td><label id="ref"></label></td>
          <td><label><strong>Title: </strong></label></td>
          <td><label id="title"></label></td>
        </tr>
        <tr>
          <td><label><strong>Fee: </strong></label></td>
          <td><label id="fee"></label></td>
          <td><label><strong>Bidding Date: </strong></label></td>
          <td><label id="bid"></label></td>
        </tr>
      </table><br><hr><br>
      <h3 style="text-align: left;">Personal Details</h3>
      <table>
        <tr>
          <td><label><strong>Name: </strong></label></td>
          <td><label id="name"></label></td>
          <td><label><strong>DOB: </strong></label></td>
          <td><label id="dob"></label></td>
          <td><label><strong>Designation: </strong></label></td>
          <td><label id="desg"></label></td>
        </tr>
        <tr>
          <td><label><strong>Aadhar No: </strong></label></td>
          <td><label id="aadhar"></label></td>
          <td><label><strong>Email: </strong></label></td>
          <td><label id="email"></label></td>
          <td><label><strong>Contact No: </strong></label></td>
          <td><label id="contact"></label></td>
        </tr>
      </table><br><hr><br>
      <h3 style="text-align: left;">Company Details</h3>
      <table>
        <tr>
          <td><label><strong>Name: </strong></label></td>
          <td><label id="cname"></label></td>
          <td><label><strong>Legal Status: </strong></label></td>
          <td><label id="legal"></label></td>
          <td><label><strong>Estd Year: </strong></label></td>
          <td><label id="yoe"></label></td>
        </tr>
        <tr>
          <td><label><strong>Registration No: </strong></label></td>
          <td><label id="register"></label></td>
          <td><label><strong>GST No: </strong></label></td>
          <td><label id="gst"></label></td>
          <td><label><strong>PAN No: </strong></label></td>
          <td><label id="pan"></label></td>
        </tr>
        <tr>
          <td><label><strong>Email: </strong></label></td>
          <td><label id="cemail"></label></td>
          <td><label><strong>Contact No: </strong></label></td>
          <td><label id="ccontact"></label></td>
          <td><label><strong>Address: </strong></label></td>
          <td><label id="address"></label></td>
        </tr>
      </table><hr>
    </div id='pdf2'>
      <div class="upload_documents">
        <h3 style="text-align: left;">Uploaded Documents</h3><br>
        <table>
          <tr>
            <th>Sr.No.</th>
            <th>File name</th>
            <th>File URI</th>
            <th>File Link</th>
          </tr>
          <tr>
            <td>1</td>
            <td>Tehnical</td>
            <td id="file1"></td>
            <td><a href="">Preview</a></td>
          </tr> 
          <tr>
            <td>2</td>
            <td>BOQ</td>
            <td id="file2"></td>
            <td><a href="">Preview</a></td>
          </tr> 
        </table>  
      </div><hr>
      <div class="payment_details" id="pdf3">
        <h3  style="text-align: left;">Payment Details</h3><br>
        <table>
          <tr>
            <th>Transaction ID</th>
            <th>Amount</th>
            <th>Date & Time</th>
            <th>Bank Name</th>
            <th>Payment Method</th>
            <th>Status</th>
          </tr> 
          <tr>
            <td id="transaction"></td>
            <td id="amt"></td>
            <td id="date"></td>
            <td id="bank"></td>
            <td >Debit Card</td>
            <td id="status" style="color: #008000;"></td>
          </tr> 
        </table> 
      </div><br>
    </div>
      <div id="download">
        <div style="float: left;">
            <p><strong>Place:</strong></p>
            <p id="place">MUMBAI</p><br>
            <p><strong>Date:</strong></p>
            <p id="da_te"></p><br>
            <p><strong>Time:</strong></p>
            <p id="time"></p><br>
          </div>
          <div style="float: right;"  onclick="print3()">
            <a ><img src="images/pdf.gif" width="55px" height="55px"></a><br>
            <a>Download</a>
          </div><br>
      </div>
      <div  class="submit_button" style="display: none;">
        <!-- <button type="button" onclick="back()">Back</button> -->
        <button id ="freeze" type="submit" onclick="freeze()">Freeze Bid</button>
      </div>
    </div>
  </body>

<script type="text/javascript">
    var log_a = document.getElementById("log_a")
    var nav_bar = document.getElementById("nav_bar")
    if(get_cookie("vcd_id_e") != "")
        {
            log_a.setAttribute("href", "/v6_profile.html");
            log_a.innerHTML ="Profile"
            nav_bar.insertAdjacentHTML('beforeend','<a id="log_a" onclick="return theFunctionV();">Log out</a>');
        }
</script>
<script type="text/javascript" src="javascript/v5_confirm_tender.js"></script>
<script type="text/javascript">
  var base64Img = null;
margins = {
  top: 70,
  bottom: 40,
  left: 30,
  width: 550
};

  var d = new Date();
  document.getElementById("da_te").innerHTML = d.getDate() + "-" + d.getMonth() + "-" + d.getFullYear();
  document.getElementById("time").innerHTML = d.getHours() + ":" + d.getMinutes() + ":" + d.getSeconds();

  function print() {const filename  = 'ThisIsYourPDFFilename.pdf';
//   let pdf = new jsPDF('p', 'mm', 'a2');

// html2canvas(document.querySelector('#pdf'), 
//             {scale: 1}
//          ).then(canvas => {
//   pdf.addImage(canvas.toDataURL('image/png'), 'PNG', 30, -190, 211, 298);
//   pdf.save(filename);
// });

// var doc = new jsPDF();

//    doc.fromHTML($('#pdf')[0], 15, 15, {
//       width: 170
//    }, function() {
//       doc.save('sample-file.pdf');
//    });
// var cache_width = $('#pdf').width(); //Criado um cache do CSS
//     var a4 = [595.28, 841.89]; // Widht e Height de uma folha a4

    
//         // Setar o width da div no formato a4
//         $("#pdf").width((a4[0] * 1.33333) - 80).css('max-width', 'none');

//         // Aqui ele cria a imagem e cria o pdf
//         html2canvas($('#pdf'), {
//             onrendered: function (canvas) {
//                 var img = canvas.toDataURL("image/jpeg", 1.0);
//                 //var doc = new jsPDF({ unit: 'px', format: 'a4' });//this line error
//                 var doc = new jsPDF('landscape'); // default is portrait
//                 doc.addImage(img, 'JPEG', 20, 20);
//                 doc.save('NOME-DO-PDF.pdf');
//                 //Retorna ao CSS normal
//                 $('#pdf').width(cache_width);
//             }
//         });
    

		// const filename  = 'ThisIsYourPDFFilename.pdf';

		// html2canvas(document.querySelector('#pdf')).then(canvas => {
		// 	let pdf = new jsPDF('p', 'mm', 'a1');
		// 	pdf.addImage(canvas.toDataURL('image/png'), 'PNG', 0, 0, 211, 298);
		// 	pdf.save(filename);
    // });
    


    // var doc = new jsPDF('p','mm', 'a2');
    // var header = [1,2,3,4];
    // doc.table(10, 10, $('#t1').get(0), header, {
    // left:10,
    // top:10,
    // bottom: 10,
    // width: 170,
    // autoSize:false,
    // printHeaders: true
    // });
    // doc.save('sample-file.pdf');
	}

// Variant
// This one lets you improve the PDF sharpness by scaling up the HTML node tree to render as an image before getting pasted on the PDF.
function print2() {
		const filename  = 'ThisIsYourPDFFilename.pdf';

		html2canvas(document.querySelector('#pdf'), 
								{scale: 1}
						 ).then(canvas => {
			let pdf = new jsPDF('p', 'mm', 'a2');
			pdf.addImage(canvas.toDataURL('image/png'), 'PNG', 10, 0, 350, 400);
			pdf.save(filename);
    });


  


  }
  

  function print3(){
    console.log(message)
    var doc = new jsPDF('p', 'mm', [297, 210]);
 
    // doc.text('Hello world!', 10, 10)
    // doc.addPage();
    // doc.setFontSize(22);
    // doc.text(20, 20, 'Answers');
    // doc.setFontSize(16);

    doc.setFontSize(26);
    doc.text('Application Form',70,25)

    doc.setFontSize(22);
    doc.setFont("times");
    doc.setFontType("italic");
    doc.text('Status: ',147,40)
    doc.setTextColor(127,255,0);
    doc.text('Submitted',170,40)

    doc.setFontSize(16);
    doc.setFontType("bold");
    doc.setTextColor(0,0,0);
    doc.text("Tender Details",10,50)
    doc.setFontType("");
    doc.setFontSize(12);
    doc.text("Tender Id: "+ et_id + "\tRefernce number: "+message.result0[0].et_tender_ref_no + "\tTitle: "+message.result0[0].et_title,15,60)
    doc.text("Fee : "+ message.result0[0].et_tender_fee + "\tBidding Date: "+message.result0[0].et_bidding_date.slice(0,-14),15,70)

    doc.setFontSize(16);
    doc.setFontType("bold");
    doc.setTextColor(0,0,0);
    doc.text("Personal Details",10,90)
    doc.setFontType("");
    doc.setFontSize(12);
    doc.text("Name: "+ message.result1[0].vcd_name + "\tDOB: "+message.result1[0].vcd_dob + "\tDesignation: "+message.result1[0].vcd_designation,15,100)
    doc.text("Aadhar No: "+ message.result1[0].vcd_aadhar + "\tEmail: "+message.result1[0].vcd_email,15,110)

    doc.setFontSize(16);
    doc.setFontType("bold");
    doc.setTextColor(0,0,0);
    doc.text("Company Details",10,130)
    doc.setFontType("");
    doc.setFontSize(12);
    doc.text("Name: "+ message.result1[0].v_name + "\tLegal Status: "+message.result1[0].v_legal_id+ "\tEstd Year: "+message.result1[0].v_yoe,15,140)
    doc.text("Registration No: "+ message.result1[0].v_reg_no+ "\tGST No: "+message.result1[0].v_gst+"\tPAN No: "+message.result1[0].v_pan ,15,150)
    doc.text("Email: "+ message.result1[0].v_email+ "\tContact No: "+message.result1[0].v_mobile,15,160)
    doc.text("Address: " +message.result1[0].v_address,15,170)

    // doc.setFontSize(16);
    // doc.setFontType("bold");
    // doc.setTextColor(0,0,0);
    // doc.text("Uploaded Documents",10,190)
    // doc.setFontType("");
    // doc.setFontSize(12);
    // doc.textWithLink("Tehnical: ",15,200, {url: message.result2[0].furi1})
    // doc.textWithLink("BOQ: ",15,210, {url: message.result2[0].furi2})
 
    // doc.setFontSize(16);
    // doc.setFontType("bold");
    // doc.setTextColor(0,0,0);
    // doc.text("Payment Details",10,210)
    // doc.setFontType("");
    // doc.setFontSize(12);
    // doc.text("Transaction ID: "+ message.result2[0].txn_id + "\tAmount: "+message.result2[0].txn_amount+ "\tDate & Time: "+message.result2[0].txn_timestamp,15,220)
    // doc.text("Bank Name: "+ message.result2[0].bank_name + "\tPayment Method: "+"Debit card"+ "\tStatus: "+message.result2[0].resp_message,15,230)
 
 
    doc.setFontSize(16);
    doc.setFontType("");
    doc.text("Place: ",10,250)
    doc.setFontType("bold");
    doc.setFontSize(16);
    doc.text("Mumbai",25,250)

    doc.setFontSize(16);
    doc.setFontType("");
    doc.text("Date: ",10,260)
    doc.setFontType("bold");
    doc.setFontSize(16);
    doc.text(d.getDate() + "-" + d.getMonth() + "-" + d.getFullYear(),25,260)

    doc.setFontSize(16);
    doc.setFontType("");
    doc.text("Time: ",10,270)
    doc.setFontType("bold");
    doc.setFontSize(16);
    doc.text(d.getHours() + ":" + d.getMinutes() + ":" + d.getSeconds(),25,270)

    doc.save("Preview")

  }
</script>
</html>
